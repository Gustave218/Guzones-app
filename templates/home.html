{% extends "base.html" %}
{% block content %}

{% if banners %}
<div class="promo-fullbleed">
  <div id="promoCarousel" class="carousel slide" data-bs-ride="carousel">

    <!-- INDICATORS -->
    <div class="carousel-indicators">
      {% for b in banners %}
      <button type="button"
              data-bs-target="#promoCarousel"
              data-bs-slide-to="{{ loop.index0 }}"
              class="{% if loop.first %}active{% endif %}"
              aria-current="{% if loop.first %}true{% endif %}">
      </button>
      {% endfor %}
    </div>

    <!-- SLIDES -->
    <div class="carousel-inner">

      {% for b in banners %}
      <div class="carousel-item {% if loop.first %}active{% endif %}">
        <div class="banner-wrapper position-relative">

          <a href="{{ url_for('banner_detail', banner_id=b.id) }}">
    {% if b.image.startswith('http') %}
        <img src="{{ b.image }}"
             class="d-block w-100 banner-img"
             alt="Banner">
    {% else %}
        <img src="{{ url_for('static', filename=b.image) }}"
             class="d-block w-100 banner-img"
             alt="Banner">
    {% endif %}
</a>

          <!-- CTA -->
          <a href="{{ url_for('banner_detail', banner_id=b.id) }}"
             class="banner-cta"
             style="background-color: {{ b.cta_color }};">
            {{ b.cta_text }}
          </a>

        </div>
      </div>
      {% endfor %}

    </div>
  </div>
</div>
{% endif %}

<!-- ===================== -->
<!-- SHOP BY CATEGORY (SWIPE STYLE) -->
<!-- ===================== -->

<div class="category-wrapper">

  <div class="category-scroll">

    {% for category in categories %}
    <a href="{{ url_for('products_by_category', category_id=category.id) }}"
       class="category-item">

        <div class="category-box">
            <span class="category-icon">
                {{ category.icon }}
            </span>
        </div>

        <div class="category-name">
            {{ category.name_fr if g.lang == 'fr' else category.name_en }}
        </div>

    </a>
    {% endfor %}

  </div>

</div>

<!-- ===================== -->
<!-- NEW ARRIVALS -->
<!-- ===================== -->
<h4 class="section-title">{{ t.new_arrivals }}</h4>

<div class="horizontal-wrapper">
  <div class="horizontal-scroll">

    {% for product in new_arrivals %}
    <div class="horizontal-card">

      <a href="{{ url_for('product_detail', product_id=product.id) }}" class="product-link">

        <div class="image-wrapper">

          {% if product.images %}
            {% set img = product.images[0].image %}
            {% if img.startswith('http') %}
              <img src="{{ img }}" loading="lazy" class="new-img">
            {% else %}
              <img src="{{ url_for('static', filename=img) }}" loading="lazy" class="new-img">
            {% endif %}
          {% else %}
            <img src="{{ url_for('static', filename='images/placeholder.png') }}" loading="lazy" class="new-img">
          {% endif %}

        </div>

        <div class="product-info">
          <div class="product-title one-line">
            {{ product.name_fr if g.lang == 'fr' else product.name_en }}
          </div>

          <div class="product-price">
            {{ product | money }}
          </div>
        </div>

      </a>
    </div>
    {% endfor %}

  </div>
</div>


<!-- ===================== -->
<!-- PRODUCT TABS -->
<!-- ===================== -->

<div class="product-tabs">
  <button class="tab-btn active" onclick="switchTab('for-you', this)">
    For You
  </button>
  <button class="tab-btn" onclick="switchTab('trending', this)">
    {{ t.trending }}
  </button>
  <button class="tab-btn" onclick="switchTab('sale', this)">
    {{ t.on_sale }}
  </button>
</div>


<!-- ===================== -->
<!-- TAB CONTENT -->
<!-- ===================== -->

<!-- FOR YOU -->
<div id="for-you" class="tab-content active">
  <div class="for-you-grid">
    {% for product in products %}
      <div class="for-you-card">

        <a href="{{ url_for('product_detail', product_id=product.id) }}" class="for-you-img-wrapper">
          {% if product.images %}
            {% set img = product.images[0].image %}
            {% if img.startswith('http') %}
              <img src="{{ img }}">
            {% else %}
              <img src="{{ url_for('static', filename=img) }}">
            {% endif %}
          {% else %}
            <img src="{{ url_for('static', filename='images/placeholder.png') }}">
          {% endif %}
        </a>

        <div class="for-you-info">
          <div class="for-you-title">
            {{ product.name_fr if g.lang == 'fr' else product.name_en }}
          </div>

          <div class="for-you-price">
            {{ product | money }}
          </div>
        </div>

      </div>
    {% endfor %}
  </div>
</div>


<!-- TRENDING -->
<div id="trending" class="tab-content">
  <div class="for-you-grid">
    {% for product in trending %}
      <div class="for-you-card">

        <a href="{{ url_for('product_detail', product_id=product.id) }}" class="for-you-img-wrapper">
          {% if product.images %}
            {% set img = product.images[0].image %}
            {% if img.startswith('http') %}
              <img src="{{ img }}">
            {% else %}
              <img src="{{ url_for('static', filename=img) }}">
            {% endif %}
          {% else %}
            <img src="{{ url_for('static', filename='images/placeholder.png') }}">
          {% endif %}
        </a>

        <div class="for-you-info">
          <div class="for-you-title">
            {{ product.name_fr if g.lang == 'fr' else product.name_en }}
          </div>

          <div class="for-you-price">
            {{ product | money }}
          </div>
        </div>

      </div>
    {% endfor %}
  </div>
</div>


<!-- ON SALE -->
<div id="sale" class="tab-content">
  <div class="for-you-grid">
    {% for product in on_sale %}
      <div class="for-you-card">

        <a href="{{ url_for('product_detail', product_id=product.id) }}" class="for-you-img-wrapper">
          {% if product.images %}
            {% set img = product.images[0].image %}
            {% if img.startswith('http') %}
              <img src="{{ img }}">
            {% else %}
              <img src="{{ url_for('static', filename=img) }}">
            {% endif %}
          {% else %}
            <img src="{{ url_for('static', filename='images/placeholder.png') }}">
          {% endif %}
        </a>

        <div class="for-you-info">
          <div class="for-you-title">
            {{ product.name_fr if g.lang == 'fr' else product.name_en }}
          </div>

          <div class="for-you-price sale-price">
            {{ product | money }}
          </div>
        </div>

      </div>
    {% endfor %}
  </div>
</div>

{% endblock %}